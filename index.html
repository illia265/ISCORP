import React, { useState, useEffect, useRef } from 'react';
import { Beaker, MessageSquare, ClipboardList, Menu, X } from 'lucide-react';
import Chart from 'chart.js/auto';

// --- Data (In a real app, this might come from a CMS or API) ---

const profile = {
    name: "Illia Shkliar",
    tagline: "Student researcher specializing in biomedical imaging and a passionate science communicator dedicated to making complex biology accessible to all.",
    imageUrl: "https://media.licdn.com/dms/image/v2/D5603AQFbUHb5vUPXkw/profile-displayphoto-shrink_200_200/B56ZY7zF44GUAY-/0/1744759972996?e=2147483647&v=beta&t=VXakGbRSjfExvijwR_HSoo99ML6uGkOClxLOznt9MZ0",
    linkedin: "https://www.linkedin.com/in/illia-shkliar/",
    email: "mailto:illiashkliar265@gmail.com",
};

const navigationLinks = [
    { href: "#journey", text: "Journey" },
    { href: "#competencies", text: "Competencies" },
    { href: "#impact", text: "Impact" },
    { href: "#publications", text: "Publications" },
];

const journeyData = [
    {
        date: "Summer 2025",
        type: "Fellowship",
        title: "SCI³ Mini-Fellowship",
        institution: "Stanford University, School of Medicine",
        description: "Selected for a competitive fellowship focused on advanced scientific research, technology, and inclusion, featuring intensive workshops and direct mentorship from Stanford faculty.",
        color: "sky"
    },
    {
        date: "March 2025",
        type: "Publication",
        title: "Published in npj Imaging",
        institution: "Nature Portfolio",
        description: "Co-authored \"Translation of Hyperpolarized [13C,15N]2Urea MRI for Novel Human Brain Perfusion Studies,\" contributing to a first-in-human clinical trial.",
        color: "emerald"
    },
    {
        date: "January 2025",
        type: "Presentation",
        title: "Co-First Author at ISMRM",
        institution: "International Society for Magnetic Resonance in Medicine",
        description: "Abstract \"D₂O vs H₂O Dissolutions for Enhancing Human MR Imaging...\" selected for a digital poster presentation, highlighting significant intellectual contribution to the project.",
        color: "amber"
    },
     {
        date: "November 2024",
        type: "Leadership",
        title: "President, Gen Core Biology",
        institution: "501(c)(3) Non-Profit",
        description: "Lead a global organization to democratize biology education, growing the platform to over 128K followers and 120M views across 12 international branches.",
        link: "https://gcbiology.org/",
        color: "indigo"
    },
    {
        date: "June 2023",
        type: "Research",
        title: "Began Research at UCSF",
        institution: "Surbek Laboratory for Advanced Imaging",
        description: "Started multi-year tenure as a student researcher, leading quality control for MRI coils and contributing to hyperpolarized MRI studies under the mentorship of Dr. Daniel Vigneron.",
        color: "rose"
    },
];

const competenciesData = [
    { icon: <Beaker size={32} />, title: "Metabolic Imaging Research", description: "Extensive hands-on experience in hyperpolarized carbon-13 MRI at UCSF, from data acquisition and quality control to analysis using MATLAB and MestreNova for novel cancer and brain perfusion studies.", color: "sky" },
    { icon: <MessageSquare size={32} />, title: "Science Communication", description: "Lead Gen Core Biology, a global non-profit that leverages social media to make AP Biology concepts engaging and accessible, reaching millions of students worldwide.", link: "https://gcbiology.org/", color: "indigo" },
    { icon: <ClipboardList size={32} />, title: "Clinical Case Studies", description: "Co-authored multiple peer-reviewed clinical case reports focusing on post-COVID-19 neurological symptoms in Ukrainian women, demonstrating a commitment to purposeful, community-relevant research.", color: "emerald" },
];

const publicationsData = [
    { type: "Journal Publication", title: "Translation of Hyperpolarized [13C,15N]2Urea MRI for Novel Human Brain Perfusion Studies", authors: "Kim, Y., Chen, zH.-Y., Nickels, T., Shkliar, I., et al.", journal: "npj Imaging (Nature Portfolio), 2025", link: "https://www.nature.com/articles/s44303-025-00073-3", color: "sky" },
    { type: "Conference Presentation", title: "D₂O vs H₂O Dissolutions for Enhancing Human MR Imaging...", authors: "Kim, Y.*, Shkliar, I.*, et al.", journal: "Accepted at International Society for Magnetic Resonance in Medicine (ISMRM), 2025", link: null, color: "amber" },
    { type: "Journal Publication", title: "A Case of Mild Depression Episode with Cognitive Impairment...", authors: "Orlova, N., Shkliar, I.", journal: "EJBS, 2024", link: "https://www.researchgate.net/publication/381879833_A_CASE_OF_MILD_DEPRESSION_EPISODE_WITH_COGNITIVE_IMPAIRMENT_AND_SUICIDAL_THOUGHTS_IN_UKRAINIAN_WOMAN_AFTER_COVID-19", color: "sky" },
    { type: "Journal Publication", title: "Dysgeusia in Ukrainian Woman with COVID: Case Report", authors: "Orlova, N., Shkliar, M., Shkliar, I.", journal: "Yumed Text, 2023", link: "https://www.researchgate.net/publication/369377874_Dysgeusia_in_Ukrainian_Woman_with_COVID_Case_Report", color: "sky" },
];

// --- Reusable Components ---

const Header = ({ name, links }) => {
    const [isMenuOpen, setIsMenuOpen] = useState(false);

    const handleScroll = (e, href) => {
        e.preventDefault();
        setIsMenuOpen(false); // Close menu on link click
        const targetElement = document.querySelector(href);
        if (targetElement) {
            const headerOffset = 70; // Adjusted for better placement
            const elementPosition = targetElement.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
      
            window.scrollTo({
                 top: offsetPosition,
                 behavior: "smooth"
            });
        }
    };

    return (
        <header id="header" className="bg-white/90 backdrop-blur-sm sticky top-0 z-50 shadow-sm">
            <nav className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="flex items-center justify-between h-16">
                    <div className="flex-shrink-0">
                        <a href="#hero" onClick={(e) => handleScroll(e, "#hero")} className="text-xl font-bold text-slate-800">{name}</a>
                    </div>
                    <div className="hidden md:block">
                        <div className="ml-10 flex items-baseline space-x-4">
                            {links.map((link) => (
                                <a key={link.href} href={link.href} onClick={(e) => handleScroll(e, link.href)} className="text-slate-600 hover:text-sky-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">
                                    {link.text}
                                </a>
                            ))}
                        </div>
                    </div>
                    <div className="md:hidden">
                        <button onClick={() => setIsMenuOpen(!isMenuOpen)} className="p-2 rounded-md text-slate-600 hover:text-sky-600 hover:bg-slate-100" aria-label="Open menu">
                           {isMenuOpen ? <X size={24} /> : <Menu size={24} />}
                        </button>
                    </div>
                </div>
                <div className={`md:hidden ${isMenuOpen ? 'block' : 'hidden'} border-t border-slate-200`}>
                    <div className="pt-2 pb-3 space-y-1 sm:px-3">
                        {links.map((link) => (
                             <a key={link.href} href={link.href} onClick={(e) => handleScroll(e, link.href)} className="text-slate-600 hover:text-sky-600 hover:bg-slate-50 block px-3 py-2 rounded-md text-base font-medium">
                                {link.text}
                            </a>
                        ))}
                    </div>
                </div>
            </nav>
        </header>
    );
};

const Hero = ({ profile }) => (
    <section id="hero" className="pt-20 pb-16 sm:py-24 bg-white">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div className="flex flex-col md:flex-row items-center gap-8 md:gap-12">
                <div className="flex-shrink-0">
                    <img className="h-40 w-40 sm:h-48 sm:w-48 rounded-full object-cover shadow-lg border-4 border-white" src={profile.imageUrl} alt={profile.name} onError={(e) => { e.target.onerror = null; e.target.src='https://placehold.co/200x200/e2e8f0/64748b?text=IS'; }} />
                </div>
                <div className="text-center md:text-left">
                    <h1 className="text-4xl sm:text-5xl font-bold tracking-tight text-slate-900">{profile.name}</h1>
                    <p className="mt-4 text-base sm:text-lg text-slate-600 max-w-2xl">{profile.tagline}</p>
                    <div className="mt-8 flex items-center justify-center md:justify-start gap-x-6">
                        <a href={profile.linkedin} target="_blank" rel="noopener noreferrer" className="rounded-md bg-sky-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-sky-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-sky-600 transition-colors">
                            View LinkedIn
                        </a>
                        <a href={profile.email} className="text-sm font-semibold leading-6 text-slate-900">Contact Me <span aria-hidden="true">→</span></a>
                    </div>
                </div>
            </div>
        </div>
    </section>
);

const Journey = ({ items }) => {
    const [activeIndex, setActiveIndex] = useState(0);

    const colorClasses = {
        bg: { sky: 'bg-sky-500', emerald: 'bg-emerald-500', amber: 'bg-amber-500', indigo: 'bg-indigo-500', rose: 'bg-rose-500' },
        tagBg: { sky: 'bg-sky-100', emerald: 'bg-emerald-100', amber: 'bg-amber-100', indigo: 'bg-indigo-100', rose: 'bg-rose-100' },
        tagText: { sky: 'text-sky-700', emerald: 'text-emerald-700', amber: 'text-amber-700', indigo: 'text-indigo-700', rose: 'text-rose-700' },
    };

    return (
        <section id="journey" className="py-20 sm:py-24">
            <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="text-center mb-12 sm:mb-16">
                    <h2 className="text-3xl sm:text-4xl font-bold tracking-tight text-slate-900">My Journey</h2>
                    <p className="mt-4 text-base sm:text-lg text-slate-600">An interactive timeline of my key experiences.</p>
                </div>
                <div className="relative">
                    <div className="absolute top-0 w-1 h-full bg-slate-200 left-5 md:left-1/2 md:-ml-0.5"></div>
                    {items.map((item, index) => (
                        <div key={index} className="relative pl-12 md:pl-0 mb-10 last:mb-0">
                            <div className="md:flex items-start">
                                <div className="md:w-1/2 md:pr-8 md:text-right">
                                    <div className="md:hidden">
                                        <h3 onClick={() => setActiveIndex(index)} className="text-base sm:text-lg font-semibold text-slate-800 cursor-pointer flex-col sm:flex-row items-start sm:items-center flex">
                                            <span className="font-bold mr-2">{item.date}</span>
                                            <span className={`mt-1 sm:mt-0 text-xs font-medium px-2.5 py-0.5 rounded-full ${colorClasses.tagBg[item.color]} ${colorClasses.tagText[item.color]}`}>{item.type}</span>
                                        </h3>
                                    </div>
                                </div>
                                <div className={`absolute w-8 h-8 ${colorClasses.bg[item.color]} rounded-full border-4 border-white cursor-pointer top-0 left-5 -ml-4 md:left-1/2`} onClick={() => setActiveIndex(index)}></div>
                                <div className="md:w-1/2 md:pl-8">
                                    <div className="hidden md:block">
                                        <h3 onClick={() => setActiveIndex(index)} className="text-base sm:text-lg font-semibold text-slate-800 cursor-pointer flex-col sm:flex-row items-start sm:items-center flex">
                                            <span className="font-bold mr-2">{item.date}</span>
                                            <span className={`mt-1 sm:mt-0 text-xs font-medium px-2.5 py-0.5 rounded-full ${colorClasses.tagBg[item.color]} ${colorClasses.tagText[item.color]}`}>{item.type}</span>
                                        </h3>
                                    </div>
                                    <div className={`transition-all duration-500 ease-in-out overflow-hidden ${activeIndex === index ? 'max-h-[500px] opacity-100 mt-2' : 'max-h-0 opacity-0'}`}>
                                        <h4 className="text-md font-bold text-slate-900">
                                            {item.link ? <a href={item.link} target="_blank" rel="noopener noreferrer" className="text-sky-600 hover:underline">{item.title}</a> : item.title}
                                        </h4>
                                        <p className="text-sm text-slate-500">{item.institution}</p>
                                        <p className="mt-2 text-slate-600 text-sm sm:text-base">{item.description}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        </section>
    );
};

const CompetencyCard = ({ icon, title, description, link, color }) => {
     const colorClasses = { text: { sky: 'text-sky-500', indigo: 'text-indigo-500', emerald: 'text-emerald-500' } };
    
    return (
         <div className="bg-slate-50 p-6 sm:p-8 rounded-lg shadow-sm hover:shadow-lg transition-shadow duration-300">
            <div className={`${colorClasses.text[color]} mb-4`}>{icon}</div>
            <h3 className="text-lg sm:text-xl font-semibold text-slate-900">{title}</h3>
            <p className="mt-2 text-slate-600 text-sm sm:text-base">
                {description.includes("Gen Core Biology") ? 
                    <>Lead <a href={link} target="_blank" rel="noopener noreferrer" className="text-sky-600 hover:underline">Gen Core Biology</a>, a global non-profit that leverages social media to make AP Biology concepts engaging and accessible, reaching millions of students worldwide.</>
                    : description
                }
            </p>
        </div>
    );
};

const Competencies = ({ items }) => (
    <section id="competencies" className="py-20 sm:py-24 bg-white">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div className="text-center mb-12 sm:mb-16">
                <h2 className="text-3xl sm:text-4xl font-bold tracking-tight text-slate-900">Core Competencies</h2>
                <p className="mt-4 text-base sm:text-lg text-slate-600">My work is centered around three key pillars.</p>
            </div>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                {items.map((item, index) => <CompetencyCard key={index} {...item} />)}
            </div>
        </div>
    </section>
);

const ImpactChart = () => {
    const chartContainer = useRef(null);
    const chartInstance = useRef(null);

    useEffect(() => {
        if (chartInstance.current) {
            chartInstance.current.destroy();
        }
        if (chartContainer.current) {
            const ctx = chartContainer.current.getContext('2d');
            chartInstance.current = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Followers', 'International Branches', 'Impressions (in Millions)'],
                    datasets: [{
                        label: 'Gen Core Biology Impact',
                        data: [128000, 12, 120],
                        backgroundColor: ['rgba(56, 189, 248, 0.6)', 'rgba(129, 140, 248, 0.6)', 'rgba(16, 185, 129, 0.6)'],
                        borderColor: ['rgba(56, 189, 248, 1)', 'rgba(129, 140, 248, 1)', 'rgba(16, 185, 129, 1)'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: {
                            type: 'logarithmic',
                            ticks: {
                                callback: (value) => {
                                    if ([10, 100, 1000, 10000, 100000, 1000000].includes(value)) {
                                        return value >= 1000000 ? `${value / 1000000}M` : value >= 1000 ? `${value / 1000}K` : value;
                                    }
                                    return null;
                                }
                            }
                        }
                    }
                }
            });
        }
        return () => {
            if (chartInstance.current) {
                chartInstance.current.destroy();
            }
        };
    }, []);

    return (
         <section id="impact" className="py-20 sm:py-24">
            <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="text-center mb-12 sm:mb-16">
                    <h2 className="text-3xl sm:text-4xl font-bold tracking-tight text-slate-900">Visualizing Impact</h2>
                    <p className="mt-4 text-base sm:text-lg text-slate-600">The growth and global reach of Gen Core Biology.</p>
                </div>
                <div className="relative w-full max-w-[600px] mx-auto h-[350px] md:h-[400px]">
                    <canvas ref={chartContainer}></canvas>
                </div>
            </div>
        </section>
    );
};


const Publications = ({ items }) => {
    const colorClasses = {
        text: { sky: 'text-sky-600', amber: 'text-amber-600' }
    };
    return (
        <section id="publications" className="py-20 sm:py-24 bg-white">
            <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="text-center mb-12 sm:mb-16">
                    <h2 className="text-3xl sm:text-4xl font-bold tracking-tight text-slate-900">Publications & Presentations</h2>
                    <p className="mt-4 text-base sm:text-lg text-slate-600">A selection of my contributions to the scientific community.</p>
                </div>
                <ul className="space-y-8">
                    {items.map((pub, index) => (
                        <li key={index} className="p-6 bg-slate-50 rounded-lg shadow-sm">
                            <p className={`text-sm font-medium ${colorClasses.text[pub.color]}`}>{pub.type}</p>
                            <h3 className="mt-2 text-lg font-semibold text-slate-800">
                                {pub.link ? (
                                    <a href={pub.link} target="_blank" rel="noopener noreferrer" className="hover:text-sky-600 transition-colors">{pub.title}</a>
                                ) : pub.title}
                            </h3>
                            <p className="mt-1 text-sm text-slate-500" dangerouslySetInnerHTML={{ __html: pub.authors.replace('Shkliar, I.', '<b>Shkliar, I.</b>') }}></p>
                            <p className="mt-1 text-sm text-slate-500 italic">{pub.journal}</p>
                        </li>
                    ))}
                </ul>
            </div>
        </section>
    );
};


// --- Main App Component ---
export default function App() {
    return (
        <div className="bg-slate-100 text-slate-700 font-sans">
            <Header name={profile.name} links={navigationLinks} />
            <main>
                <Hero profile={profile} />
                <Journey items={journeyData} />
                <Competencies items={competenciesData} />
                <ImpactChart />
                <Publications items={publicationsData} />
            </main>
            <footer className="bg-slate-800 text-slate-300">
                <div className="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8 text-center">
                    <p>&copy; {new Date().getFullYear()} {profile.name}. All rights reserved.</p>
                </div>
            </footer>
        </div>
    );
}
